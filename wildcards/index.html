<!DOCTYPE html><html lang="en" prefix="og:http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="language" content="en"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Alex Ostrovski"><meta name="keywords" content="ed25519, cryptography"><meta name="description" content="One of the counter-intuitive feats of Ed25519 is that there are signatures matching any given message (or at least, a non-trivial fraction of messages, say, 1/8)."><meta name="og:title" content="Wildcard signatures"><meta name="og:description" content="One of the counter-intuitive feats of Ed25519 is that there are signatures matching any given message (or at least, a non-trivial fraction of messages, say, 1/8)."><meta name="og:type" content="article"><title>Wildcard signatures | Ed25519 Quirks</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/solid.css" integrity="sha384-aj0h5DVQ8jfwc8DA7JiM+Dysv7z+qYrFYZR+Qd/TwnmpDI6UaB3GJRRTdY8jYGS4" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/regular.css" integrity="sha384-l+NpTtA08hNNeMp0aMBg/cqPh507w3OvQSRoGnHcVoDCS9OtgxqgR7u8mLQv8poF" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/fontawesome.css" integrity="sha384-WK8BzK0mpgOdhCxq86nInFqSWLzR5UAsNg0MGX9aDaIIrFWQ38dGdhwnNCAoXFxL" crossorigin="anonymous"><link rel="stylesheet" href="../base.css"></head><body><header class="body-header"><div class="container"><h1 class="display-3"><a class="d-block" href="..">Ed25519 Quirks</a></h1><nav class="navbar navbar-expand-lg navbar-light px-0 pb-0"><button class="navbar-toggler mb-1" type="button" data-toggle="collapse" data-target="#main-nav-content" aria-controls="main-nav-content" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="main-nav-content"><ul class="navbar-nav mr-auto"><li class="nav-item"><a class="nav-link" href="../basics/">Basics</a></li><li class="nav-item"><a class="nav-link" href="../malleability/">Malleability</a></li><li class="nav-item active"><a class="nav-link" href="../wildcards/">Wildcards</a></li></ul><ul class="navbar-nav"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Settings</a><div class="dropdown-menu dropdown-menu-right"><h6 class="dropdown-header">Encoding</h6><form class="mx-3 my-1" id="encoding-form"><div class="custom-control custom-radio custom-control-inline"><input class="custom-control-input" id="encoding-hex" type="radio" name="encoding" value="hex"><label class="custom-control-label" for="encoding-hex">Hex</label></div><div class="custom-control custom-radio custom-control-inline"><input class="custom-control-input" id="encoding-base64" type="radio" name="encoding" value="base64"><label class="custom-control-label" for="encoding-base64">Base64</label></div></form></div></li></ul></div></nav></div></header><div class="container pt-4"><p class="lead">One of the counter-intuitive feats of Ed25519 is that there are signatures matching any
given message (or at least, a non-trivial fraction of messages, say, 1/8).
</p><p>This result doesn’t break Ed25519: the signatures are valid under a specifically generated public key,
which cannot be obtained with valid key generation. Still, it looks <em>fascinating</em>.</p><p>To obtain “wildcard” signatures, let’s first take the identity point as the public key: <code>A = O</code>.
The verification equation</p><p class="px-2 py-1 bg-light equation text-monospace">[s]B = R + [H(R ‖ A ‖ M)]A</p><p>loses the second term on the right-hand side; no matter the value of the hash scalar <code>H(R ‖ A ‖ M)</code>,
when multiplied by the identity, it yields <code>O</code>. The equation transforms into <code>[s]B = R</code>;
thus, signature <code>([s]B, s)</code> for any possible scalar <code>s</code> is a valid signature
for <em>any</em> message under public key <code>O</code>.
</p><h3>Torsion Points</h3><p>The identity point has conspicuous serialization <code>0x0100…00</code>. Not to fear; there are other public keys
that lead to almost the same result. These 8 points form the <em>torsion subgroup</em>
on the Ed25519 elliptic curve <code>G<sub>tors</sub></code>;
for any such point <code>E</code>, <code>[8]E = O</code>. The torsion group is isomorphic to integers modulo 8,
i.e., we can select a group generator <code>E<sub>1</sub></code>, such that the group is</p><p class="px-2 py-1 bg-light equation text-monospace">G<sub>tors</sub> = {
O, E<sub>1</sub>, E<sub>2</sub> ≡ [2]E<sub>1</sub>, …, E<sub>7</sub> ≡ [7]E<sub>1</sub>
}.</p><p>For any public key <code>A</code> in <code>G<sub>tors</sub></code>, with probability
at least 1/8 over message space, the hash scalar <code>H([s]B ‖ A ‖ M)</code> is divisible
by the point order (1, 2, 4 or 8). In this case, signature <code>([s]B, s)</code> will still be valid.
</p><div id="app"><div class="loading-progress card my-2 small"><div class="card-body"><h6 class="card-title">Loading interactive parts…</h6><p class="card-text">This may take some time. <i class="text-muted fas fa-spinner fa-spin"></i></p></div></div></div><div class="row mt-4"><div class="col-md-5 mb-1 mb-md-0"><a href="../malleability/"><span class="text-muted">←</span>Malleable signatures</a></div></div><footer class="page-footer small text-muted"><span class="copyright">© 2019 Alex Ostrovski. Licensed under
<a rel="license" href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>.</span><div class="float-none float-sm-right"><a href="../about/">About</a>&nbsp;•
<a href="https://github.com/slowli/ed25519-quirks">GitHub</a></div></footer></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script><script>$(function() {
  var encoding = localStorage.getItem('encoding') || '';
  if (['hex', 'base64'].indexOf(encoding) < 0) {
    encoding = 'base64';
    localStorage.setItem('encoding', encoding);
  }

  $('input[name=encoding]').each(function(el) {
    var $this = $(this);
    $this.prop('checked', $this.val() === encoding);
  }).change(function() {
    localStorage.setItem('encoding', $('input[name=encoding]:checked').val());
  });
});
</script><script src="../wildcards.js"></script></body></html>